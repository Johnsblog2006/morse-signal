<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’Œæ–‡ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·å¤‰æ›</title>
    <style>
        body { 
            font-family: "SF Pro Display", "SF Pro Icons", "Helvetica Neue", "Helvetica", "Arial", sans-serif; 
            text-align: center; 
            margin: 20px; 
            background-image: url('/Users/sherlock/Library/Mobile Documents/com~apple~CloudDocs/KAZU/Create./Morse/British.jpg'); /* â†ã“ã“ã‚’å¤‰æ›´å¯èƒ½ */
            background-size: cover; 
            background-position: center; 
            background-attachment: fixed;
            color: white;
        }
        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(87, 87, 87, 0.351); /* ğŸ”¥ é»’ã®åŠé€æ˜ï¼ˆ0.0 = å®Œå…¨é€æ˜, 1.0 = ä¸é€æ˜ï¼‰ */
            z-index: -1; /* èƒŒæ™¯ã‚’ä¸‹ã«é…ç½® */
        }
        textarea, input { 
            width: 80%; 
            margin: 10px 0; 
            padding: 10px; 
            font-size: 1.2em; 
            border: 2px solid #354158; 
            border-radius: 10px;
        }
        button { 
            padding: 12px 20px; 
            font-size: 1em; 
            margin: 5px; 
            cursor: pointer; 
            border: none; 
            background-color: #3c628b; 
            color: white; 
            border-radius: 50px; 
            transition: 0.3s;
        }
        button:hover { 
            background-color: #0056b3; 
        }
        #output, #outputMorse, #history { 
            font-size: 1.5em; 
            font-weight: bold; 
            margin-top: 20px; 
            color: #fffefe;
        }
        h1, h2 { 
            color: #ffffff; 
        }
    </style>
</head>
<body>
    <h1>å’Œæ–‡ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·å¤‰æ›</h1>
    
    <h2>ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å· â†’ æ—¥æœ¬èª</h2>
    <textarea id="morseInput" placeholder="ä¾‹: .- -.-- / ..-"></textarea>
    <button onclick="convertToJapanese()">å¤‰æ›</button>
    <button onclick="playMorseSound()">éŸ³ã‚’å†ç”Ÿ</button>
    <div id="output">è§£èª­çµæœ: </div>

    <h2>æ—¥æœ¬èª â†’ ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·</h2>
    <input type="text" id="japaneseInput" placeholder="ä¾‹: ã‚¢ã‚¤ã‚¦ã‚¨ã‚ª">
    <button onclick="convertToMorse()">å¤‰æ›</button>
    <div id="outputMorse">ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·: </div>

    <h2>å±¥æ­´</h2>
    <div id="history">å±¥æ­´ãªã—</div>
    <button onclick="clearHistory()">å±¥æ­´ã‚’ã‚¯ãƒªã‚¢</button>

    <script>
        // å’Œæ–‡ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®å¯¾å¿œè¡¨ï¼ˆåŠè§’ `.` `-` ã«çµ±ä¸€ï¼‰
        const morseToJapanese = {
            ".-": "ã‚¤", ".-.-": "ãƒ­", "-...": "ãƒ", "-.-.": "ãƒ‹",
            "-..": "ãƒ›", ".": "ãƒ˜", "..-..": "ãƒˆ", "..-.": "ãƒ",
            "--.": "ãƒª", "....": "ãƒŒ", "-.-.-.": "ãƒ«", ".---": "ãƒ²",
            "-.-": "ãƒ¯", ".-..": "ã‚«", "--": "ãƒ¨", "-.": "ã‚¿",
            "---": "ãƒ¬", "---.": "ã‚½", ".--.": "ãƒ„", "--.-": "ãƒ",
            ".-.": "ãƒŠ", "...": "ãƒ©", "-": "ãƒ ", "..-": "ã‚¦",
            ".-..-": "ãƒ°", "..--": "ãƒ", ".-...": "ã‚ª", "...-": "ã‚¯",
            ".--": "ãƒ¤", "-..-": "ãƒ", "-.-.": "ã‚±", "--..": "ãƒ•",
            "----": "ã‚³", "-.---": "ã‚¨", ".-.-.": "ãƒ†", "--.--": "ã‚¢",
            "-.-.-": "ã‚µ", "-.-..": "ã‚­", "-..--": "ãƒ¦", "-...-": "ãƒ¡",
            "..-.-": "ãƒŸ", "--.-.": "ã‚·", "---.-": "ã‚¹", ".-.-.": "ãƒ³",
            "--..-": "ãƒ’", "-..-.-": "ãƒ¢", ".----.": "ã‚»", "..": "ã‚›", "..--.": "ã‚œ"
        };

        const japaneseToMorse = Object.fromEntries(
            Object.entries(morseToJapanese).map(([morse, kana]) => [kana, morse])
        );

        // å…¨è§’ã€Œãƒ»ã€ã€Œï¼ã€ã‚’åŠè§’ã€Œ.ã€ã€Œ-ã€ã«å¤‰æ›
        function normalizeMorse(input) {
            return input.replace(/ãƒ»/g, ".").replace(/ï¼/g, "-");
        }

        // ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å· â†’ æ—¥æœ¬èªå¤‰æ›
        function convertToJapanese() {
            let input = document.getElementById("morseInput").value.trim();
            input = normalizeMorse(input); // å…¨è§’è¨˜å·ã‚’åŠè§’è¨˜å·ã«å¤‰æ›
            const words = input.split(" / ");
            const translated = words.map(word =>
                word.split(" ").map(symbol => morseToJapanese[symbol] || "?").join("")
            ).join(" ");
            document.getElementById("output").textContent = "è§£èª­çµæœ: " + translated;
            addToHistory(`ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã€Œ${input}ã€ â†’ æ—¥æœ¬èªã€Œ${translated}ã€`);
        }

        // æ—¥æœ¬èª â†’ ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·å¤‰æ›
        function convertToMorse() {
            const input = document.getElementById("japaneseInput").value.trim().split("");
            const translated = input.map(char => japaneseToMorse[char] || "?").join(" ");
            document.getElementById("outputMorse").textContent = "ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·: " + translated;
            addToHistory(`æ—¥æœ¬èªã€Œ${input.join("")}ã€ â†’ ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã€Œ${translated}ã€`);
        }

        // ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®éŸ³ã‚’å†ç”Ÿ
        function playMorseSound() {
            let input = document.getElementById("morseInput").value.trim();
            input = normalizeMorse(input);
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            let time = audioCtx.currentTime;

            input.split(" ").forEach(symbol => {
                if (symbol === ".") {
                    playBeep(audioCtx, time, 0.1); // çŸ­éŸ³
                    time += 0.2;
                } else if (symbol === "-") {
                    playBeep(audioCtx, time, 0.3); // é•·éŸ³
                    time += 0.4;
                } else {
                    time += 0.6; // ã‚¹ãƒšãƒ¼ã‚¹ï¼ˆå˜èªåŒºåˆ‡ã‚Šï¼‰
                }
            });
        }

        // ãƒ“ãƒ¼ãƒ—éŸ³ã‚’é³´ã‚‰ã™
        function playBeep(audioCtx, startTime, duration) {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = "sine";
            oscillator.frequency.setValueAtTime(700, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(1, audioCtx.currentTime);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start(startTime);
            oscillator.stop(startTime + duration);
        }

        // å±¥æ­´ã‚’ä¿å­˜
        function addToHistory(text) {
            const historyDiv = document.getElementById("history");
            if (historyDiv.textContent === "å±¥æ­´ãªã—") {
                historyDiv.textContent = "";
            }
            const entry = document.createElement("div");
            entry.textContent = text;
            historyDiv.appendChild(entry);
        }

        // å±¥æ­´ã‚’ã‚¯ãƒªã‚¢
        function clearHistory() {
            document.getElementById("history").textContent = "å±¥æ­´ãªã—";
        }
    </script>
</body>
</html>